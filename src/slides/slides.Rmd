---
title: "Bringing together marine biodiversity, environmental and maritime boundaries data in R"
author: "Salvador Fernandez, Laura Marquez"
date: "May 30 2022"
output: 
  revealjs::revealjs_presentation:
    css: styles.css
    theme: simple
    slide_level: 2
    transition: none
    # includes:
    #   in_header: header.html
    # self_contained: false
    # reveal_plugins: ["notes"]
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(collapse = TRUE)
```

<img src="images/image2.png" style="width:50%">

<div style="font-size: 30px;" >
Bringing together marine biodiversity, environmental and maritime boundaries data in R
</div>

Salvador Fernandez, 
Laura Marquez, 
Lotte Pohl

May 30th 2022

<img src="images/vliz.png" style="width:15%">
<img src="images/lifewatch.png" style="width:15%">


<!-- ```{r} -->
<!-- library(lwdataexplorer) -->
<!-- library(revealjs) -->
<!-- library(mregions2) -->
<!-- library(eurobis) -->
<!-- library(sdmpredictors) -->
<!-- library(worrms) -->
<!-- ``` -->


## 
=======
# The Story

<!-- Having rapid access to reliable and accurate information is vital in different areas: conservation, research, and in creating policies and legislation to protect vulnerable areas of our coasts and oceans. 

(1) However, we have several sources of information where we can obtain a diverse set of data from and different ways to obtain it. 

so the question is what is the workflow that allows us to obtain data and work with it in the most easy straightforward way possible? -->

<img class="plain" data-src="images2/pic1_.jpg">


## 
=======
<span style="color:red">*Image of taxon and occurrence data*</span>
*Solea solea* meme

<!-- ----------------------------------------------------------------------- -->

<!-- ## Proper collections allow humans and machines to find the data -->

<!-- <img class="plain" data-src="images/sources.jpg" style="width:65%"> -->


<!-- ## Data reuse  -->

<!-- leads to: discovery, innovation & scientific integration -->

<!-- <img class="plain" data-src="images/reusedata.jpg" style="width:75%"> -->

<!-- There is a diverse set of stakeholders, from academia, industry, funding agencies and scholarly publishers can benefit from having a workflow to access standardized marine biological, chemical, physical, and other different types of data. -->

<img class="plain" data-src="images2/pic2.png" style="width:75%">


## 

<!-- An important user of the databases that we are going to work with today is the scientific community. For scientists, obtaining this kind of information is useful to create the basis of different projects or even to obtain data they need to carry them out. Some of the questions that arise for them when creating such projects are -->

##

<img class="plain" data-src="images2/pic3.jpg">

##

<img class="plain" data-src="images2/pic4.jpg">

##

<img class="plain" data-src="images2/pic5.jpg">

##

<img class="plain" data-src="images2/pic6.jpg">

=======
<!-- ## FAIR principles -->

<!-- <img class="plain" data-src="images/fair-data.png" style="width:85%"> -->

<!-- ----------------------------------------------------------------------- -->

## Who we are

<button style="width:26%">
  <img src="images/Salva.jpg">
  <br> **Salva Fernandez** <br/> VLIZ <br/>Science Officer<br/> salvador.fernandez@vliz.be
</button>

<button style="width:43%">
  <img src="images/Laura.png">
  <br> **Laura Marquez** <br /> VLIZ <br/>Science Officer<br/> laura.marquez@vliz.be
</button>

<button style="width:25%">
  <img src="images/Lotte.jpg">
  <br> **Lotte Pohl** <br /> VLIZ/IMBRSea <br/>Intern<br /> lotte.pohl@imbrsea.eu 
</button>

<!-- <img data-src="images/Salva.jpg" style="float:left;width:20%"/> -->
<!-- <img src="images/Laura.png" style="float:center;width:20%"/> -->
<!-- <img src="images/Lotte.jpg" style="float:right;width:20%"/> -->
<!-- <br /> -->
<!-- <small style="float:left;">**Salva Fernandez** <br/> VLIZ <br/>Science Officer<br/> salvador.fernandez@vliz.be </small> -->
<!-- <small style="float:center;">**Laura Marquez** <br /> VLIZ <br/>Science Officer<br/> laura.marquez@vliz.be</small> -->
<!-- <small style="float:right;">**Lotte Pohl** <br /> VLIZ/IMBRSea <br/>Intern<br /> lotte.pohl@imbrsea.eu </small> -->

## What we will learn

 1. How to access, query and obtain the data

 2. Visualize and get them ready for further exploration and analyses using R
     

## 
<!-- To answer those type of questions is the aim of this workshop. We are going to learn how to query, access and obtain the data hold in different European Marine databases and for that we are going to work with some of the representative species: 
Anguila, carp, catfish, the common roach, codfish and flounder.
-->

<img class="plain" data-src="images2/Anguilla.jpg">

##
<img class="plain" data-src="images2/carp.jpg">

##
<img class="plain" data-src="images2/catfish.jpg">

##
<img class="plain" data-src="images2/commonroach.jpg">

##
<img class="plain" data-src="images2/cod.jpg">

##
<img class="plain" data-src="images2/flounder.jpg">


## We will learn

<!-- We will learn to visualize and get them ready for further exploration and analyses. All using the R packages available from different European initiatives: lwdataexplorer, eurobis, worrms, mregions, sdmpredictors.
-->

 1. How to access, query and obtain the data

 2. Visualize and get them ready for further exploration and analyses using R
     
=======
 3. R packages: 
     - **lwdataexplorer** ([documentation](https://lifewatch.github.io/lwdataexplorer/index.html), [github](https://github.com/lifewatch/lwdataexplorer))
     - **eurobis** ([documentation](http://lifewatch.github.io/eurobis/), [github](https://github.com/lifewatch/eurobis))
     - **worrms** ([documentation](https://docs.ropensci.org/worrms/), [github](https://github.com/ropensci/worrms))
     - **mregions2** ([documentation](http://lifewatch.github.io/mregions2/), [github](https://github.com/lifewatch/mregions2/))
     - **sdmpredictors** ([documentation](http://lifewatch.github.io/sdmpredictors/), [github](https://github.com/lifewatch/sdmpredictors))
     - **emodnetWFS** ([documentation](https://emodnet.github.io/EMODnetWFS/), [github](https://github.com/EMODnet/EMODnetWFS/))

## Overview

<img class="plain" data-src="images/Rpackages_overview.png" style="width:85%">


## Exercises *(TBD)*

  1. Get and standardize data
  
      * [LifeWatch](https://lifewatch.be): Get marine taxon occurrences
      * [WoRMS](https://www.marinespecies.org): Get standardised taxon info
      * [marineregions](https://marineregions.org): Get standardised geospatial data

  2. Get more occurrence data
  
      * [EurOBIS](https://www.eurobis.org): Get marine taxon occurrences

  3. Get environmental data
  
      * [Bio-ORACLE](https://bio-oracle.org): Get pH, temperature & salinity
      * [EMODnet Biology](https://emodnet-biology.eu): Get seabed habitats & human activities

  4. Combine it all together
  
  
## Exercises

<img class="plain" data-src="images/pipeline.png" style="width:85%">


## Timeline (13:30 - 16:30)

  1. **Introduction** *(13:30 - 14:00)*
  
  2. **Exercise 1** *(14:00 - 14:45)*
  
  3. **Break** *(14:45 - 15:00)*
  
  4. **Exercise 2** *(15:00 - 15:30)*
  
  5. **Exercise 3** *(15:30 - 15:45)*
  
  6. **Coffee Break** *(15:45 - 16:00)*
  
  7. **Exercise 4** *(16:30 - 16:15)*
  
  8. **Close-off** *(16:15 - 16:30)*

# Exercise 1

<img src="images/ex1.png" style="width:85%">

**Use your own data!**

## Geospatial Data and Operations

<button style="width:40%">
  <img src="images/intersect.png">
  <br> **spatial intersection**
</button>

<button style="width:40%">
  <img src="images/union.png">
  <br> **spatial union**
</button>

<br/>
<br/>

[Coordinate Reference System (CRS)](https://docs.qgis.org/2.18/en/docs/gentle_gis_introduction/coordinate_reference_systems.html):
<br/>
<img src="images/crs.jpg" style="width:35%">


## AphiaID and MRGID

<button style="width:40%">
  <img src="images/turtle.jpg">
  <br> AphiaID <br/> https://www.marinespecies.org/aphia.php?p=image&pic=116025&tid=137205 
</button>

<button style="width:40%">
  <img src="images/mrgid.png">
  <br> MRGID <br /> text
</button>

<!-- ## Notes: -->

<!--   - LifeWatch Belgium: a virtual laboratory for biodiversity research -->
<!--   - `lwdataexplorer` R package: retrieves biodiversity, environmental or genetic data from projects supported by LifeWatch -->
 <!-- - WoRMS: [World Register of Marine Species](https://www.marinespecies.org/). -->
 <!-- - Aphia ID: Unique identifier for each taxon -->
 <!-- - `worrms` R package: performs taxon match -->
 <!-- - input: scientific name of species or other taxa -->
 <!-- - output: all data about that taxa in WoRMS, including the AphiaID  -->
 <!-- - If geometry data is available: retrieved record in R has class `sf` -->
 <!-- - `sf`: format used for spatial operations -->


# Exercise 2

<img src="images/ex2.png" style="width:85%">

## Raster vs Vector Data
<br>
<br>

<button style="width:40%">
  <img src="images/raster.png">
  <br> **raster layer**
</button>

<button style="width:40%">
  <img src="images/vector.png">
  <br> **vector layer**
</button>


## Dplyr

 - works with pipes (`%>%`) to increase code readability and avoid nesting
 - `mean(as.numeric(df$temp))` translates to `df$temp %>% as.numeric() %>% mean()`
 - cheatsheet [here](https://nyu-cdsc.github.io/learningr/assets/data-transformation.pdf)

<img src="images/dplyr.png" style="width:70%"> 


<!-- ## Notes -->

<!--   - EurOBIS: European Node of the international Ocean Biodiversity Information System -->
<!--   - Provides access to distribution data of marine species -->
<!--   - `eurobis` R package: retrieves EurOBIS data -->
<!--   - Marine Regions = geographical backbone, WoRMS = taxonomic backbone -->
<!--   - Data can be accessed via the AphiaID for a specific taxon or the MRGID for a specific place -->
<!-- The EurOBIS database uses Marine Regions and WoRMS as geographical and taxonomic backbones. -->
<!-- This means that you can ask for data of an specific taxon via the AphiaID, and data from an specific place with the Marine Regions Gazetteer Identifier or MRGID. -->
# Exercise 3

<img src="images/ex3.png" style="width:85%">

<!-- ## Notes -->
<!--   - EMODnet: European Marine Observation and Data Network -->
<!--  - `eurobis` R package: uses the EMODnet-Biology webservices -->
<!--   - there are web services for other types of data:  -->
<!--    - physical -->
<!--    - seabed habitats -->
<!--    - human activities -->
<!--  - `EMODnetWFS` R package: can access all these data -->
<!--  - WFS: Web Feature Service (provides access to vector data) -->
<!--  - Accessing raster data: available later in 2022 -->

## Attention

<button style="width:40%">
  <img src="images/intersect.png">
  <br> **spatial intersection**
</button>

<button style="width:40%">
  <img src="images/union.png">
  <br> **spatial intersection**
</button>

<br>
<br>

**Attention:** `raster::extract()` and `sf::st_join` both do a spatial join. The former is used for raster data, the second one for vector data!

# Exercise 4

<img src="images/ex4.png" style="width:85%">

# Have fun!


```{r render, include = FALSE, eval = FALSE}
rmarkdown::render("slides.Rmd", output_dir = "../../docs", output_file = "index.html")
```